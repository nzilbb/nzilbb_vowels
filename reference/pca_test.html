<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PCA with confidence intervals and null distributions — pca_test • nzilbb.vowels</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PCA with confidence intervals and null distributions — pca_test"><meta name="description" content="Permute and bootstrap data fed to PCA n times. Bootstrapped data is used to
estimate confidence bands for variance explained by each PC and for each
loading. Squared loadings are multiplied by the squared eigenvalue of the
relevant PC. This ranks the loadings of PCs which explain a lot of variance
higher than those from PCs which explain less. This approach to PCA testing
follows Carmago (2022) and Vieria (2012). This approach differs from
Carmago's PCAtest package by separating data generation and plotting."><meta property="og:description" content="Permute and bootstrap data fed to PCA n times. Bootstrapped data is used to
estimate confidence bands for variance explained by each PC and for each
loading. Squared loadings are multiplied by the squared eigenvalue of the
relevant PC. This ranks the loadings of PCs which explain a lot of variance
higher than those from PCs which explain less. This approach to PCA testing
follows Carmago (2022) and Vieria (2012). This approach differs from
Carmago's PCAtest package by separating data generation and plotting."><meta property="og:image" content="https://nzilbb.github.io/nzilbb_vowels/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nzilbb.vowels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Model-to-PCA-workflow.html">Model-to-PCA workflow</a></li>
    <li><a class="dropdown-item" href="../articles/Rotation.html">PCA and Rotation</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://joshua.wilsonblack.nz/posts/nzilbb-vowels-0-3-1/">nzilbb.vowels 0.3.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nzilbb/nzilbb_vowels/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>PCA with confidence intervals and null distributions</h1>
      <small class="dont-index">Source: <a href="https://github.com/nzilbb/nzilbb_vowels/blob/main/R/pca_test.R" class="external-link"><code>R/pca_test.R</code></a></small>
      <div class="d-none name"><code>pca_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Permute and bootstrap data fed to PCA <code>n</code> times. Bootstrapped data is used to
estimate confidence bands for variance explained by each PC and for each
loading. Squared loadings are multiplied by the squared eigenvalue of the
relevant PC. This ranks the loadings of PCs which explain a lot of variance
higher than those from PCs which explain less. This approach to PCA testing
follows Carmago (2022) and Vieria (2012). This approach differs from
Carmago's PCAtest package by separating data generation and plotting.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pca_test</span><span class="op">(</span></span>
<span>  <span class="va">pca_data</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  variance_confint <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  loadings_confint <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pca-data">pca_data<a class="anchor" aria-label="anchor" href="#arg-pca-data"></a></dt>
<dd><p>data fed to the <code>prcomp</code> function.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>the number of times to permute and bootstrap that data. <strong>Warning:</strong> high values
will take a long time to compute.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>whether the PCA variables should be scaled (default: TRUE).</p></dd>


<dt id="arg-variance-confint">variance_confint<a class="anchor" aria-label="anchor" href="#arg-variance-confint"></a></dt>
<dd><p>size of confidence intervals for variance explained
(default: 0.95).</p></dd>


<dt id="arg-loadings-confint">loadings_confint<a class="anchor" aria-label="anchor" href="#arg-loadings-confint"></a></dt>
<dd><p>size of confidence intervals for index loadings
(default: 0.9).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>object of class <code>pca_test_results</code>, containing:</p><ul><li><p><code>$variance</code> a tibble containing the variances explained and confidence
intervals for each PC.</p></li>
<li><p><code>$loadings</code> a tibble containing the index loadings and confidence intervals
for each variable and PC.</p></li>
<li><p><code>$raw_data</code> a tibble containing the variance explained and loadings for
each bootstrapped and permuted analysis.</p></li>
<li><p><code>$variance_confint</code> confidence intervals applied to variance explained.</p></li>
<li><p><code>$loadings_confint</code> confidence interval applied to loadings.</p></li>
<li><p><code>$n</code> the number of iterations of both permutation and bootstrapping.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Default confidence bands on variance explained at 0.95 (i.e. alpha of 0.05).
In line with Vieria (2012), the default confidence bands on the index
loadings are at 0.9.</p>
<p>See <code><a href="plot_loadings.html">plot_loadings()</a></code> and <code><a href="plot_variance_explained.html">plot_variance_explained()</a></code> for useful plotting
functions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Camargo, Arley (2022),
PCAtest: testing the statistical significance of Principal Component
Analysis in R. <em>PeerJ</em> 10. e12967.
doi:10.7717/peerj.12967</p>
<p>Vieira, Vasco (2012): Permutation tests to estimate significances on
Principal Components Analysis. <em>Computational Ecology and Software</em> 2.
103–123.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">onze_pca</span> <span class="op">&lt;-</span> <span class="fu">pca_test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">onze_intercepts</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">speaker</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">onze_pca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCA Permutation and Bootstrapping Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significant PCs at 0.05 level: PC1, PC2, PC3, PC4, PC5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significant loadings at 0.1 level: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F1_FLEECE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F1_GOOSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F1_START</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F1_THOUGHT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F1_TRAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F2_FLEECE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F2_NURSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F2_STRUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC1: F2_THOUGHT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F1_DRESS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F1_FLEECE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F1_NURSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F2_DRESS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F2_KIT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F2_LOT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F2_STRUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F2_THOUGHT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC2: F2_TRAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC3: F2_GOOSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC3: F2_LOT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC3: F2_NURSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC4: F1_KIT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC4: F1_LOT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC5: F1_STRUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC5: F2_KIT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC5: F2_START</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC5: F2_STRUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC6: F1_DRESS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC6: F1_NURSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC6: F2_START</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC8: F1_KIT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC9: F1_LOT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC10: F1_THOUGHT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	PC11: F2_DRESS</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua Wilson Black, James Brand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

